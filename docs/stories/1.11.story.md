# Story 1.11: Welcome Message Display for Empty Media Pool

## Status: Draft

## Story

- As a User
- when the media pool is empty
- I want to see an informative message guiding me on how to add media
- so that I know how to get started.

## Acceptance Criteria (ACs)

- AC 11.1: Given the application loads and the media pool is empty (either initially or after clearing media), then a specific text message, like "Welcome to VJ Tam Tam, please drag and drop your photos and videos here, or click to browse, to start your performance", is displayed prominently on the stage area.
- AC 11.2: When the user adds media to the empty pool, the welcome/instruction text disappears.
- AC 11.3: The welcome/instruction text is styled clearly and centered on the stage.

## Tasks / Subtasks

- [ ] Task 1: Implement clear media pool functionality for testing (Prerequisite for AC validation)
  - [ ] Subtask 1.1: Add "Clear Media" button to UI (temporary or permanent based on product decision)
  - [ ] Subtask 1.2: Implement `clearMediaPool()` method in StateManager
  - [ ] Subtask 1.3: Handle cleanup of media object URLs to prevent memory leaks
  - [ ] Subtask 1.4: Emit appropriate events when media pool is cleared
  - [ ] Subtask 1.5: Ensure playback engine stops when media pool is cleared

- [ ] Task 2: Validate current welcome message implementation (AC: 11.1, 11.3)
  - [ ] Subtask 2.1: Verify welcome message displays on initial app load with empty media pool
  - [ ] Subtask 2.2: Verify welcome message displays after media pool is cleared (requires Task 1)
  - [ ] Subtask 2.3: Confirm message text matches AC 11.1 specification
  - [ ] Subtask 2.4: Validate welcome message styling and positioning
  - [ ] Subtask 2.5: Test welcome message clickability for file browsing

- [ ] Task 3: Validate welcome message hide/show behavior (AC: 11.2)
  - [ ] Subtask 3.1: Test welcome message hides when media is added via drag-and-drop
  - [ ] Subtask 3.2: Test welcome message hides when media is added via file picker
  - [ ] Subtask 3.3: Test welcome message shows when all media is removed/cleared (requires Task 1)
  - [ ] Subtask 3.4: Test welcome message behavior with temporary vs persistent files
  - [ ] Subtask 3.5: Test welcome message behavior with files that need permission

- [ ] Task 4: Enhance welcome message functionality if needed (AC: 11.1, 11.2, 11.3)
  - [ ] Subtask 4.1: Refactor hardcoded welcome text to use centralized strings (if not done)
  - [ ] Subtask 4.2: Improve welcome message styling for better visibility and UX
  - [ ] Subtask 4.3: Add accessibility attributes for screen readers
  - [ ] Subtask 4.4: Optimize welcome message responsive behavior

- [ ] Task 5: Test edge cases and integration (All ACs)
  - [ ] Subtask 5.1: Test welcome message with restored media pool on page reload
  - [ ] Subtask 5.2: Test welcome message during file processing delays
  - [ ] Subtask 5.3: Test welcome message with error states (failed file loads)
  - [ ] Subtask 5.4: Test welcome message interaction with playback engine state

## Dev Technical Guidance

### Context & Purpose

This story validates and enhances the welcome message functionality that guides users when the media pool is empty. The welcome message is the first interaction point for new users and provides clear guidance on how to add media to start the VJ experience.

**‚ö†Ô∏è Critical Dependency**: Full validation of AC 11.2 requires the ability to clear the media pool, which doesn't currently exist in the application. Task 1 addresses this prerequisite.

### Current Implementation Analysis

Based on codebase analysis, the welcome message system appears to be largely implemented:

‚úÖ **Existing Implementation:**
- HTML structure: `#welcome-message` div in `app/index.html` with proper content
- CSS styling: Welcome message positioned in stage area (needs verification)
- JavaScript logic: `updateWelcomeMessageVisibility()` in `UIManager` class
- String constants: Welcome text centralized in `STRINGS.USER_INTERFACE.welcome`
- Integration: Connected to media pool state changes via EventBus

‚ùì **Needs Validation:**
- Proper hide/show behavior with different media pool states
- Styling quality and responsiveness
- Accessibility compliance
- Edge case handling

‚ùå **Missing for Complete Testing:**
- Clear media pool functionality to test AC 11.2 "show when pool becomes empty"

### Key Implementation Areas

#### 1. Clear Media Pool Functionality (New Requirement)
```javascript
// Add to StateManager class
clearMediaPool() {
  // Clean up object URLs to prevent memory leaks
  this.state.mediaPool.forEach(item => {
    if (item.url && item.url.startsWith('blob:')) {
      URL.revokeObjectURL(item.url)
    }
  })
  
  // Clear the media pool
  this.state.mediaPool = []
  
  // Emit events
  eventBus.emit('state.mediaPoolUpdated', {
    mediaPool: [],
    totalCount: 0,
    cleared: true
  })
  
  // Save state
  this.saveState()
}
```

#### 2. UI Integration for Clear Functionality
```javascript
// Add to UIManager class - could be temporary or permanent
addClearMediaButton() {
  const clearBtn = document.createElement('button')
  clearBtn.textContent = 'üóëÔ∏è Clear Media'
  clearBtn.id = 'clear-media-btn'
  clearBtn.className = 'file-picker-btn'
  clearBtn.addEventListener('click', () => {
    if (confirm('Clear all media from the pool?')) {
      stateManager.clearMediaPool()
    }
  })
  
  // Add to existing button container
  const buttonContainer = document.querySelector('.file-picker-controls')
  buttonContainer.appendChild(clearBtn)
}
```

#### 3. Current UIManager Integration
```javascript
// Located in app/src/uiManager.js
updateWelcomeMessageVisibility() {
  const mediaItems = stateManager.getMediaPool()
  const usableMedia = filterUsableMedia(mediaItems)
  
  if (usableMedia.length > 0) {
    this.welcomeMessage.classList.add('hidden')
  } else {
    this.welcomeMessage.classList.remove('hidden')
  }
}
```

#### 4. HTML Structure (Existing)
```html
<!-- In app/index.html -->
<div id="welcome-message" class="welcome-message">
  <h1>Welcome to VJ Tam Tam</h1>
  <p>Please drag and drop your photos and videos here, or click to browse, to start your performance</p>
</div>
```

#### 5. String Constants (Existing)
```javascript
// In app/src/constants/strings.js
STRINGS.USER_INTERFACE.welcome = {
  heading: 'Welcome to VJ Tam Tam',
  instructions: 'Please drag and drop your photos and videos here, or click to browse, to start your performance'
}
```

### Testing Areas

#### 1. Behavior Validation
- Welcome message visibility on app initialization ‚úÖ (Can test immediately)
- Hide behavior when media is added (drag/drop, file picker) ‚úÖ (Can test immediately)
- Show behavior when media pool is cleared ‚ùå (Requires Task 1 implementation)
- Behavior with different media states (temporary, persistent, needs permission)

#### 2. Integration Testing
- Welcome message + media pool state synchronization
- Welcome message + playback engine integration
- Welcome message + UI event handling

#### 3. Styling and UX
- Visual positioning and centering
- Typography and readability
- Responsive behavior
- Click interaction feedback

### Critical Considerations

1. **State Synchronization**: Welcome message visibility must be perfectly synchronized with media pool state
2. **Media Filtering**: Must use `filterUsableMedia()` to distinguish between truly usable media and metadata-only items
3. **Memory Management**: Clear functionality must properly clean up object URLs
4. **Accessibility**: Ensure screen readers can access welcome content
5. **Performance**: Minimize DOM manipulation and reflows
6. **User Experience**: Clear, friendly, and actionable guidance

### Testing Dependency Resolution

**Option 1: Temporary Clear Button**
- Add a temporary "Clear Media" button for testing purposes
- Can be removed after Epic 1 completion if not needed for production

**Option 2: Browser Developer Tools**
- Use `localStorage.clear()` or `stateManager.clearMediaPool()` in console
- More technical but doesn't require UI changes

**Option 3: Defer Full Testing**
- Test only AC 11.1 and partial AC 11.2 (hide behavior)
- Mark story as "Partially Complete" pending clear functionality

**Recommendation**: Implement Option 1 (temporary clear button) as it provides the most comprehensive testing capability and might be useful for development/debugging.

### Files to Review/Modify

- `app/src/stateManager.js` - Add clearMediaPool() method
- `app/src/uiManager.js` - Add clear button UI and welcome message validation
- `app/index.html` - Welcome message HTML structure and styling
- `app/assets/css/style.css` - Welcome message styling and responsive behavior
- `app/src/constants/strings.js` - Welcome message text constants
- Test files - Validation and integration tests

### Integration Points

1. **State Management**: Hook into `state.mediaPoolUpdated` events with `cleared: true` flag
2. **UI Events**: Coordinate with drag/drop and file picker interactions
3. **Playback Engine**: Ensure welcome message shows when playback stops due to empty pool
4. **Toast System**: Don't show welcome message conflicts with error toasts

### Architecture References

- **Component View**: `docs/component-view.md` - UIManager patterns and responsibilities
- **State Management**: `docs/data-models.md` - Media pool structure and filtering
- **UI/UX Specification**: `docs/UI-UX-Spec.md` - Welcome message design requirements

### Success Criteria Validation

The story requires **both validation and new functionality**:

1. **Validation Work**: Test existing welcome message behavior (~70% of story)
2. **New Functionality**: Implement clear media pool feature (~30% of story)
3. **Complete Testing**: Validate all acceptance criteria thoroughly

### Expected Outcome

This story will result in:
- ‚úÖ Validated welcome message functionality for initial load scenarios
- ‚úÖ New clear media pool functionality enabling complete testing
- ‚úÖ Comprehensive validation of all show/hide behaviors
- ‚úÖ Enhanced UX and accessibility improvements

## Story Progress Notes

### Agent Model Used: 

### Completion Notes List

### Change Log 