# Story 3.6: Fullscreen Toggle Button Integration

## Status: Approved

## Story

- As a User
- I want a fullscreen toggle button that integrates seamlessly with the brutalist design
- so that I can easily switch between windowed and fullscreen modes.

## Acceptance Criteria (ACs)

- **AC 6.1:** Given the UI-UX-Spec.md Section 5.2 header specifications, a fullscreen toggle button is positioned in the drawer header area with appropriate icon-based design.
- **AC 6.2:** The button's visual state (icon and tooltip) accurately reflects the current fullscreen status as specified for fullscreen controls in the UI-UX-Spec.md.
- **AC 6.3:** The button responds to external fullscreen changes (browser ESC key, F11) and updates its state accordingly, following UI-UX-Spec.md interaction principles.
- **AC 6.4:** The button styling follows the brutalist minimalism design system established in UI-UX-Spec.md Sections 1 and 2.

## Tasks / Subtasks

- [ ] Task 1: Implement Fullscreen Toggle Button UI (AC: 6.1, 6.4)
  - [ ] Subtask 1.1: Create fullscreen toggle button element in drawer header
  - [ ] Subtask 1.2: Position button appropriately in header area next to logo
  - [ ] Subtask 1.3: Implement icon-based design (fullscreen_enter/fullscreen_exit icons)
  - [ ] Subtask 1.4: Apply brutalist minimalism styling (Arial Bold, black/white colors)
  - [ ] Subtask 1.5: Ensure button integrates seamlessly with existing header layout

- [ ] Task 2: Implement Fullscreen API Integration (AC: 6.2, 6.3)
  - [ ] Subtask 2.1: Integrate with browser Fullscreen API for fullscreen toggling
  - [ ] Subtask 2.2: Implement fullscreen state detection and management
  - [ ] Subtask 2.3: Add event listeners for fullscreen state changes
  - [ ] Subtask 2.4: Handle cross-browser compatibility for Fullscreen API
  - [ ] Subtask 2.5: Implement error handling for fullscreen operations

- [ ] Task 3: Implement Dynamic Button State Management (AC: 6.2, 6.3)
  - [ ] Subtask 3.1: Create button state management for fullscreen/windowed modes
  - [ ] Subtask 3.2: Implement dynamic icon switching based on current state
  - [ ] Subtask 3.3: Add dynamic tooltip text ("Enter Fullscreen"/"Exit Fullscreen")
  - [ ] Subtask 3.4: Update button state when external fullscreen events occur (ESC, F11)
  - [ ] Subtask 3.5: Ensure button state synchronizes with actual browser fullscreen status

- [ ] Task 4: Handle External Fullscreen Events (AC: 6.3)
  - [ ] Subtask 4.1: Listen for browser fullscreen change events
  - [ ] Subtask 4.2: Detect when user exits fullscreen via ESC key
  - [ ] Subtask 4.3: Detect when user enters fullscreen via F11 key
  - [ ] Subtask 4.4: Update button state automatically when external changes occur
  - [ ] Subtask 4.5: Ensure UI idle/active state behavior works correctly in fullscreen mode

- [ ] Task 5: Integrate with UIManager and State Management (AC: 6.1, 6.2)
  - [ ] Subtask 5.1: Add fullscreen button to UIManager initialization
  - [ ] Subtask 5.2: Implement fullscreen state persistence to localStorage
  - [ ] Subtask 5.3: Restore fullscreen state on application reload if needed
  - [ ] Subtask 5.4: Integrate fullscreen events with event bus system
  - [ ] Subtask 5.5: Update UI idle/active state logic to handle fullscreen considerations

- [ ] Task 6: Implement Accessibility and User Experience (AC: 6.4)
  - [ ] Subtask 6.1: Ensure button is keyboard accessible (Tab navigation, Enter/Space activation)
  - [ ] Subtask 6.2: Implement proper ARIA labels and tooltip management
  - [ ] Subtask 6.3: Add proper focus states consistent with design system
  - [ ] Subtask 6.4: Test touch target sizing for mobile/tablet devices
  - [ ] Subtask 6.5: Ensure smooth transitions and visual feedback
  - [ ] Subtask 6.6: Handle edge cases (permissions, browser restrictions)

## Dev Notes

### Current Implementation Analysis

**Existing Header Structure:**
- UIManager handles drawer header rendering
- Header contains VJ Tam Tam logo at top position
- Header area available for additional controls
- Existing CSS styling for header elements

**Fullscreen API Integration:**
- Browser Fullscreen API: `document.documentElement.requestFullscreen()`
- Exit fullscreen: `document.exitFullscreen()`
- Fullscreen state detection: `document.fullscreenElement`
- Event listener: `document.addEventListener('fullscreenchange', handler)`

**UI-UX-Spec Requirements:**
- Section 5.2: Fullscreen toggle button in drawer header area
- Section 5.2: Icon-based design with dynamic tooltip
- Section 5.2: Button state synchronization with browser fullscreen status
- Section 4: ESC key handling in fullscreen mode (should not trigger idle state)
- Section 1 & 2: Brutalist minimalism styling (Arial Bold, black/white)

**Integration Points:**
- UIManager header initialization and rendering
- Event bus system for fullscreen state changes
- StateManager for persistence if needed
- Idle/active state management interactions
- CSS integration with existing header styling

**Technical Considerations:**
- Cross-browser Fullscreen API compatibility
- Vendor prefixes for older browsers
- Permission handling for fullscreen requests
- Error handling for fullscreen operations
- Icon asset management for fullscreen states
- Tooltip positioning and styling

### Testing

Dev Note: Story Requires the following tests:

- [ ] Jest Unit Tests: (nextToFile: true), coverage requirement: 80%
- [ ] Jest Integration Test: location: `/tests/stories/fullscreen-toggle.test.js`
- [ ] Cypress E2E: location: `/e2e/epic-3/fullscreen-functionality.spec.js`

Manual Test Steps:

- Click fullscreen toggle button to enter fullscreen mode
- Verify button icon changes to "exit fullscreen" state
- Verify tooltip updates to "Exit Fullscreen"
- Press ESC key to exit fullscreen mode
- Verify button state updates automatically
- Test F11 key for fullscreen toggling (where supported)
- Test keyboard navigation to fullscreen button
- Test button activation with Enter/Space keys
- Verify button styling matches brutalist minimalism design
- Test on different browsers for API compatibility
- Test error handling when fullscreen is not supported/allowed

## Dev Agent Record

### Agent Model Used: {{Agent Model Name/Version}}

### Debug Log References

[[LLM: (Dev Agent) If the debug is logged to during the current story progress, create a table with the debug log and the specific task section in the debug log - do not repeat all the details in the story]]

### Completion Notes List

[[LLM: (Dev Agent) Anything the SM needs to know that deviated from the story that might impact drafting the next story.]]

### Change Log

[[LLM: (Dev Agent) Track document versions and changes during development that deviate from story dev start]]

| Date | Version | Description | Author |
| :--- | :------ | :---------- | :----- | 